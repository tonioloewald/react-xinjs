{"mappings":";;;;;ACQO,MAAM,2CAAU,SACrB,QAA0B,EAC1B,YAAe;IAEf,MAAM,OAAO,OAAO,aAAa,WAAW,WAAW,CAAA,GAAA,cAAM,EAAE;IAC/D,IAAI,OAAO,SAAS,UAAU;QAC5B,QAAQ,KAAK,CACX,qDACA;QAEF,MAAM,IAAI,MAAM;IAClB;IACA,MAAM,CAAC,OAAO,OAAO,GAAG,CAAA,GAAA,eAAO,EAC7B,CAAA,GAAA,UAAE,CAAC,CAAC,KAAK,KAAK,YAAY,CAAA,GAAA,UAAE,CAAC,CAAC,KAAK,GAAG;IAExC,CAAA,GAAA,gBAAQ,EAAE;QACR,MAAM,WAAW;YACf,OAAO,CAAA,GAAA,UAAE,CAAC,CAAC,KAAK;QAClB;QACA,MAAM,WAAW,CAAA,GAAA,cAAM,EAAE,MAAM;QAC/B,OAAO;YACL,CAAA,GAAA,gBAAQ,EAAE;QACZ;IACF;IACA,MAAM,WAAW,CAAC;QAChB,CAAA,GAAA,UAAE,CAAC,CAAC,KAAK,GAAG;IACd;IACA,OAAO;QAAC;QAAO;KAAS;AAC1B;AAEO,MAAM,4CAAS","sources":["src/index.ts","src/use-xin.ts"],"sourcesContent":["export { useXin } from './use-xin'","import { useState, useEffect } from \"react\";\nimport { xin, observe, unobserve, xinPath, XinTouchableType } from \"tosijs\";\n\ntype HookType<T = any> = [value: T, setValue: (newValue: T) => void];\n\n// TODO declare type the way it's declared for useState so that TypeScript\n// passes through type of initialValue to the right thing\n\nexport const useTosi = function <T = any>(\n  observed: XinTouchableType,\n  initialValue: T,\n): HookType<T> {\n  const path = typeof observed === \"string\" ? observed : xinPath(observed);\n  if (typeof path !== \"string\") {\n    console.error(\n      \"useXin must either be passed a path or a XinProxy\",\n      observed,\n    );\n    throw new Error(\"useXin must either be passed a path or a XinProxy\");\n  }\n  const [value, update] = useState(\n    xin[path] !== undefined ? xin[path] : initialValue,\n  );\n  useEffect(() => {\n    const observer = (): void => {\n      update(xin[path]);\n    };\n    const listener = observe(path, observer);\n    return () => {\n      unobserve(listener);\n    };\n  });\n  const setValue = (value: any): void => {\n    xin[path] = value;\n  };\n  return [value, setValue];\n};\n\nexport const useXin = useTosi;\n"],"names":[],"version":3,"file":"module.js.map","sourceRoot":"../"}